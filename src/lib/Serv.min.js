// mB v6.06.07 on 2019-06-11T16:59:39.367Z
"use strict"
Object.defineProperty(exports,"__esModule",{value:!0})
var express=require("express"),bodyParser=require("body-parser"),formidable=require("express-formidable"),logger=require("tracer").console(),CustomCors=function(){function CustomCors(e){return function(r,s,t){var n=r.get("origin")
if(!n)return t()
var o=!1
if(e.forEach(function(e){"*"==e&&(o=!0),n.includes(e)&&(o=!0)}),logger.trace(n,o),o)return s.setHeader("Access-Control-Allow-Origin",n),t()
s.status(403).end()}}return CustomCors.getReqAsOrigin=function(e){var r=e.connection.encrypted?"https":"http",s=e.hostname,t=e.originalUrl
return logger.trace(t),r+"://"+s},CustomCors}()
exports.CustomCors=CustomCors
var ExpressRPC=function(){function ExpressRPC(){}return ExpressRPC.makeInstance=function(e){var r=new CustomCors(e),s=express()
return s.use(r),s.use(bodyParser.urlencoded({extended:!1})),s.use(formidable()),s},ExpressRPC.serveStatic=function(e){return express.static(e)},ExpressRPC}()
exports.ExpressRPC=ExpressRPC
var RPCBasicAuth=function(){function RPCBasicAuth(){}return RPCBasicAuth.prototype.auth=function(e,r){var s=new Buffer(e)
e=s.toString("base64")
var t=new Buffer(r)
return r=t.toString("base64"),function(s,t,n){if(void 0===s.fields.user||void 0===s.fields.pswd)t.status(401).send()
else{if(s.fields.user===e&&s.fields.pswd===r)return n()
t.status(401).send()}}},RPCBasicAuth}()
exports.RPCBasicAuth=RPCBasicAuth,module.exports={ExpressRPC:ExpressRPC,RPCBasicAuth:RPCBasicAuth}