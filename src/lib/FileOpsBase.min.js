// mB v6.06.07 on 2019-06-11T16:59:39.367Z
"use strict"
Object.defineProperty(exports,"__esModule",{value:!0})
var FileHound=require("filehound"),logger=require("tracer").console(),fs=require("fs-extra"),yaml=require("js-yaml"),path=require("path"),Dirs=function(){function Dirs(t){var r=Dirs.slash(t)
this.dir=r}return Dirs.slash=function(t){return t.replace(/\\/g,"/")},Dirs.goUpOne=function(t){return path.resolve(t,"..")},Dirs.prototype.getInDir=function(t){for(var r=FileHound.create().paths(this.dir+t).not().glob("*.js").findSync(),e=[],s=this.dir.length+t.length,i=0,n=r;i<n.length;i++){var o=n[i].substr(s)
o.includes("index.html")||(o.includes("index.pug")||e.push(o))}return e},Dirs.prototype.getShort=function(){var t=this.getFolders(),r=[],e=this.dir.length
logger.info(this.dir,e)
for(var s=0,i=t;s<i.length;s++){var n=i[s].substr(e)
r.push(n)}return r},Dirs.prototype.getFolders=function(){logger.info(this.dir)
for(var t=[],r=0,e=FileHound.create().paths(this.dir).ext("pug").findSync();r<e.length;r++){var s=e[r],i=(s=Dirs.slash(s)).lastIndexOf("/"),n=s.substring(0,i)
fs.existsSync(n+"/dat.yaml")&&t.push(n)}return Array.from(new Set(t))},Dirs}()
exports.Dirs=Dirs
var Dat=function(){function Dat(t){var r,e=Dirs.slash(t)
this._path=e,fs.existsSync(e+"/dat.yaml")&&(r=yaml.load(fs.readFileSync(e+"/dat.yaml"))),r||(r={}),this.props=r,Object.keys(r).includes("include")&&this._addData()}return Dat.prototype.write=function(){try{var t=yaml.dump(this.props,{skipInvalid:!0,noRefs:!0,noCompatMode:!0,condenseFlow:!0}),r=this._path+"/dat.yaml"
logger.info(r),fs.writeFileSync(r,t)}catch(t){logger.info(t)}},Dat.prototype.set=function(t,r){this.props[t]=r},Dat.prototype._addData=function(){var t=this.props.include,r=this._path+"/"+t
logger.info(r)
var e=fs.readFileSync(r)
Object.assign(this.props,JSON.parse(e.toString()))},Dat.prototype.getAll=function(){return this.props},Dat}()
exports.Dat=Dat,module.exports={Dat:Dat,Dirs:Dirs}