#loginScr.modal
   .modal-overlay
   .modal-container.delayShowing
      .modal-header
      .modal-body
         form.grid-form(autocomplete="off")
            fieldset
               legend Login
               div(data-row-span="1")
                  .field(data-field-span="1")
                     label Secret Code
                     input#code(type="password", autofocus="")

            br
            #loginMsg.toast.toast-warning Unable to serve. Is the secret code correct?

      .modal-footer
         button#butLog.btn  Login


script.

   function loginTry(arg) {
      console.log('try')

      const baseURL = 'http://localhost:9083' // EDIT this and mbake

      isLoggedIn(baseURL).then(function() {
            console.log('Lxxx yes')
            $('#loginScr').removeClass('active') // show app
            const aa = new AdminAuth()
            console.log(aa.secret)
            window.aSrv = new MetaAdminService(baseURL, aa.secret)
            window.login.dispatch()
            $('.delayShowing').removeClass('delayShowing')

         }, function() {
               onLogout(arg)
               $('.delayShowing').removeClass('delayShowing')

      })
   }//()

   function onLogout(arg) {
      console.log('LXXX no')
      new AdminAuth().clear()
      $('#loginScr').addClass('active') // hide app
      try {
         delete window.aSrv
      } catch(err) { console.log(err) }
      if(arg) $('#loginMsg').show(0)
      else $('#loginMsg').hide(0) // no message

   }

   function setupLogin() {
      $('#loginMsg').hide(0) // no message

      $('#butLog').click(function(){
         let code = $('#code').val()
         let aa = new AdminAuth()
         aa.save(code)
         console.log(aa.secret)
         loginTry(true)
      })
       $('#butLogOut').click(function(){
         onLogout(false)
      })

      loginTry(false)
   }

   loadjs.ready(['style','ma-client'], function () {
      setupLogin()
   })



